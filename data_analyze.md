

























































# (Pdb) pred
# tensor([[[[ 0.0598,  0.0598,  0.0598,  ...,  0.0598,  0.0598,  0.0598],
#           [-0.6306, -0.6333, -0.6360,  ..., -0.6208, -0.6239, -0.6271],
#           [-0.6369, -0.6402, -0.6448,  ..., -0.6212, -0.6275, -0.6329],
#           ...,
#           [-0.2502, -0.2471, -0.2445,  ..., -0.2585, -0.2558, -0.2529],
#           [-0.1395, -0.1376, -0.1342,  ..., -0.1489, -0.1445, -0.1413],
#           [ 0.0548,  0.0573,  0.0596,  ...,  0.0483,  0.0504,  0.0527]],

#          [[-0.0531, -0.0531, -0.0531,  ..., -0.0531, -0.0531, -0.0531],
#           [-1.7529, -1.7503, -1.7476,  ..., -1.7577, -1.7558, -1.7542],
#           [-1.6757, -1.6722, -1.6679,  ..., -1.6837, -1.6805, -1.6780],
#           ...,
#           [-1.2123, -1.2128, -1.2130,  ..., -1.2084, -1.2096, -1.2109],
#           [-1.3083, -1.3088, -1.3090,  ..., -1.3049, -1.3063, -1.3074],
#           [-1.4466, -1.4466, -1.4469,  ..., -1.4441, -1.4450, -1.4457]],

#          [[-0.4039, -0.4039, -0.4039,  ..., -0.4039, -0.4039, -0.4039],
#           [-0.4034, -0.4034, -0.4034,  ..., -0.4034, -0.4034, -0.4034],
#           [-0.4037, -0.4037, -0.4037,  ..., -0.4038, -0.4037, -0.4037],
#           ...,
#           [-2.4563, -2.4565, -2.4567,  ..., -2.4556, -2.4558, -2.4560],
#           [-2.4443, -2.4444, -2.4445,  ..., -2.4438, -2.4439, -2.4441],
#           [-2.4221, -2.4221, -2.4222,  ..., -2.4218, -2.4219, -2.4220]],

#          ...,

#          [[-0.3455, -0.3455, -0.3455,  ..., -0.3455, -0.3455, -0.3455],
#           [-0.4362, -0.4364, -0.4367,  ..., -0.4356, -0.4358, -0.4359],
#           [-0.4742, -0.4743, -0.4746,  ..., -0.4738, -0.4740, -0.4740],
#           ...,
#           [ 1.3454,  1.3454,  1.3453,  ...,  1.3459,  1.3457,  1.3456],
#           [ 1.4577,  1.4577,  1.4576,  ...,  1.4580,  1.4578,  1.4578],
#           [ 1.4992,  1.4994,  1.4995,  ...,  1.4989,  1.4991,  1.4991]],

#          [[ 1.1167,  1.1167,  1.1167,  ...,  1.1167,  1.1167,  1.1167],
#           [ 1.0721,  1.0712,  1.0702,  ...,  1.0751,  1.0740,  1.0731],
#           [ 1.0931,  1.0924,  1.0916,  ...,  1.0954,  1.0946,  1.0939],
#           ...,
#           [ 0.8228,  0.8231,  0.8232,  ...,  0.8222,  0.8224,  0.8227],
#           [ 1.0827,  1.0821,  1.0819,  ...,  1.0838,  1.0834,  1.0829],
#           [ 1.1525,  1.1523,  1.1520,  ...,  1.1534,  1.1531,  1.1528]],

#          [[-0.7792, -0.7792, -0.7792,  ..., -0.7792, -0.7792, -0.7792],
#           [-0.7819, -0.7819, -0.7819,  ..., -0.7819, -0.7819, -0.7819],
#           [-0.7846, -0.7846, -0.7846,  ..., -0.7847, -0.7847, -0.7846],
#           ...,
#           [-1.1181, -1.1181, -1.1181,  ..., -1.1181, -1.1181, -1.1181],
#           [-1.1189, -1.1189, -1.1189,  ..., -1.1189, -1.1189, -1.1189],
#           [-1.1200, -1.1200, -1.1200,  ..., -1.1200, -1.1200, -1.1200]]]],
#        device='cuda:1')


# (Pdb) pred
# tensor([[[[ -7.6190,  -0.1840,  11.5538,  ...,   8.0322,  -3.7524,   8.4657],
#           [  6.4379,   5.6664,  -9.2041,  ...,   5.4451,   9.7375,   8.7749],
#           [-12.5302,  -8.5432,  -2.0176,  ...,  13.5126,  -0.3314,  -1.9045],
#           ...,
#           [  5.2569,   6.6860,   3.4575,  ...,  -9.2148,  -0.7473,  -1.1643],
#           [  3.4418,  -5.0369,  12.0660,  ...,   3.2866,  -3.3262,  -3.2772],
#           [ -2.2158,  15.5935,   7.9789,  ...,  10.1436,  -1.2337,  14.0688]],

#          [[  4.1119,   2.2119,   7.0259,  ...,   8.6836, -12.0619,  -2.6581],
#           [ 15.4184, -11.4427,  -1.7377,  ...,  -8.4477,   5.9497,  11.7040],
#           [ -3.8656,  -0.2379,   2.8854,  ...,  -4.2116,   6.5963,   4.0215],
#           ...,
#           [ -8.1430,  -6.9176,  -1.1821,  ...,  -4.2140,  16.3196,  -3.1850],
#           [ -1.2936,  -0.2545,   5.3804,  ...,  -0.6189,   5.2967,   2.5092],
#           [ -6.9685,  -2.3678,  -4.6970,  ...,   3.9775,   0.9380,  -0.8112]],

#          [[ -9.2684,   3.5066,  -1.0553,  ...,   5.7179,   4.9328,   1.5704],
#           [ -3.8492,   2.0506,  -5.7846,  ...,  -3.7487,  -0.3962,   1.3095],
#           [ -9.1661,   6.9968,  -8.5387,  ...,  -0.5958,   1.6899,  -7.4807],
#           ...,
#           [ -7.4240,  10.0226,  -6.4051,  ...,  -0.9550,   4.9526,  -9.6167],
#           [  1.5035,  -2.3202,  -5.9843,  ...,  -0.0663,  -6.4532,  -0.6983],
#           [ -2.2455, -11.5943,  13.7957,  ...,  11.4995,  -2.4567,   6.1279]],

#          ...,

#          [[  8.7865,  14.7034,  -4.5203,  ...,  -5.1311,  -2.4492,  -5.7062],
#           [ -3.9562,  -1.8940,  -7.8182,  ...,   9.1588,   9.2190,  -0.8033],
#           [ -0.7713,   2.4966,  11.4385,  ...,  -2.6082,   7.0997,  10.2035],
#           ...,
#           [  4.7720,  -4.6457,   3.3711,  ...,   4.1496,  17.3588, -11.3686],
#           [-14.6036,  -3.4820,   8.9109,  ...,  -0.2074,   2.6685,  -0.1220],
#           [  6.5604,  -4.1247,  -0.5430,  ..., -10.1126,  -0.1031,  12.6735]],

#          [[ -2.4455,  10.3587,   4.2338,  ...,   4.5350,  -3.1760,   5.0473],
#           [ -3.9726, -11.6040,   3.2215,  ...,   1.2236,   5.2702,  -4.1844],
#           [ -8.1575,  -3.9072,   2.7374,  ..., -17.9594,  -3.5811,  12.1807],
#           ...,
#           [-11.6759,   3.8214,   1.6632,  ...,  -5.0783,  -1.9070,   4.3694],
#           [ -1.6749,   1.1669,  -0.7947,  ...,   6.4073,  -1.0351,   2.1715],
#           [  3.2424,  13.0369,  -2.5740,  ...,   2.3729,  -7.9224, -16.2727]],

#          [[-14.4565,   5.5591, -10.1666,  ...,   5.3791,  -0.7983, -10.4905],
#           [-22.1011,   0.5947,  20.9617,  ...,   5.4715,  -8.6341,  11.7901],
#           [  1.3200, -16.5490,  10.4140,  ...,  -0.4215,   3.7637, -10.3145],
#           ...,
#           [  0.7374,  -4.2234,  -3.6249,  ...,   1.9831,  -1.4112,   0.2624],
#           [  5.0181,  11.0852,  -7.3470,  ...,   7.9361,   7.8985,  -7.3152],
#           [ -2.9438,  -6.6220,  -1.3803,  ...,  -2.2411,  -1.2198,   2.1835]]]],
#        device='cuda:3')




(Pdb) data_slice[0:1]
tensor([[[[ 0.0598,  0.0598,  0.0598,  ...,  0.0598,  0.0598,  0.0598],
          [-0.6306, -0.6333, -0.6360,  ..., -0.6208, -0.6239, -0.6271],
          [-0.6369, -0.6402, -0.6448,  ..., -0.6212, -0.6275, -0.6329],
          ...,
          [-0.2502, -0.2471, -0.2445,  ..., -0.2585, -0.2558, -0.2529],
          [-0.1395, -0.1376, -0.1342,  ..., -0.1489, -0.1445, -0.1413],
          [ 0.0548,  0.0573,  0.0596,  ...,  0.0483,  0.0504,  0.0527]],

         [[-0.0531, -0.0531, -0.0531,  ..., -0.0531, -0.0531, -0.0531],
          [-1.7529, -1.7503, -1.7476,  ..., -1.7577, -1.7558, -1.7542],
          [-1.6757, -1.6722, -1.6679,  ..., -1.6837, -1.6805, -1.6780],
          ...,
          [-1.2123, -1.2128, -1.2130,  ..., -1.2084, -1.2096, -1.2109],
          [-1.3083, -1.3088, -1.3090,  ..., -1.3049, -1.3063, -1.3074],
          [-1.4466, -1.4466, -1.4469,  ..., -1.4441, -1.4450, -1.4457]],

         [[-0.4039, -0.4039, -0.4039,  ..., -0.4039, -0.4039, -0.4039],
          [-0.4034, -0.4034, -0.4034,  ..., -0.4034, -0.4034, -0.4034],
          [-0.4037, -0.4037, -0.4037,  ..., -0.4038, -0.4037, -0.4037],
          ...,
          [-2.4563, -2.4565, -2.4567,  ..., -2.4556, -2.4558, -2.4560],
          [-2.4443, -2.4444, -2.4445,  ..., -2.4438, -2.4439, -2.4441],
          [-2.4221, -2.4221, -2.4222,  ..., -2.4218, -2.4219, -2.4220]],

         ...,

         [[-0.3455, -0.3455, -0.3455,  ..., -0.3455, -0.3455, -0.3455],
          [-0.4362, -0.4364, -0.4367,  ..., -0.4356, -0.4358, -0.4359],
          [-0.4742, -0.4743, -0.4746,  ..., -0.4738, -0.4740, -0.4740],
          ...,
          [ 1.3454,  1.3454,  1.3453,  ...,  1.3459,  1.3457,  1.3456],
          [ 1.4577,  1.4577,  1.4576,  ...,  1.4580,  1.4578,  1.4578],
          [ 1.4992,  1.4994,  1.4995,  ...,  1.4989,  1.4991,  1.4991]],

         [[ 1.1167,  1.1167,  1.1167,  ...,  1.1167,  1.1167,  1.1167],
          [ 1.0721,  1.0712,  1.0702,  ...,  1.0751,  1.0740,  1.0731],
          [ 1.0931,  1.0924,  1.0916,  ...,  1.0954,  1.0946,  1.0939],
          ...,
          [ 0.8228,  0.8231,  0.8232,  ...,  0.8222,  0.8224,  0.8227],
          [ 1.0827,  1.0821,  1.0819,  ...,  1.0838,  1.0834,  1.0829],
          [ 1.1525,  1.1523,  1.1520,  ...,  1.1534,  1.1531,  1.1528]],

         [[-0.7792, -0.7792, -0.7792,  ..., -0.7792, -0.7792, -0.7792],
          [-0.7819, -0.7819, -0.7819,  ..., -0.7819, -0.7819, -0.7819],
          [-0.7846, -0.7846, -0.7846,  ..., -0.7847, -0.7847, -0.7846],
          ...,
          [-1.1181, -1.1181, -1.1181,  ..., -1.1181, -1.1181, -1.1181],
          [-1.1189, -1.1189, -1.1189,  ..., -1.1189, -1.1189, -1.1189],
          [-1.1200, -1.1200, -1.1200,  ..., -1.1200, -1.1200, -1.1200]]]],
       device='cuda:3')


(Pdb) data_slice[0:1]
tensor([[[[ 0.0598,  0.0598,  0.0598,  ...,  0.0598,  0.0598,  0.0598],
          [-0.6306, -0.6333, -0.6360,  ..., -0.6208, -0.6239, -0.6271],
          [-0.6369, -0.6402, -0.6448,  ..., -0.6212, -0.6275, -0.6329],
          ...,
          [-0.2502, -0.2471, -0.2445,  ..., -0.2585, -0.2558, -0.2529],
          [-0.1395, -0.1376, -0.1342,  ..., -0.1489, -0.1445, -0.1413],
          [ 0.0548,  0.0573,  0.0596,  ...,  0.0483,  0.0504,  0.0527]],

         [[-0.0531, -0.0531, -0.0531,  ..., -0.0531, -0.0531, -0.0531],
          [-1.7529, -1.7503, -1.7476,  ..., -1.7577, -1.7558, -1.7542],
          [-1.6757, -1.6722, -1.6679,  ..., -1.6837, -1.6805, -1.6780],
          ...,
          [-1.2123, -1.2128, -1.2130,  ..., -1.2084, -1.2096, -1.2109],
          [-1.3083, -1.3088, -1.3090,  ..., -1.3049, -1.3063, -1.3074],
          [-1.4466, -1.4466, -1.4469,  ..., -1.4441, -1.4450, -1.4457]],

         [[-0.4039, -0.4039, -0.4039,  ..., -0.4039, -0.4039, -0.4039],
          [-0.4034, -0.4034, -0.4034,  ..., -0.4034, -0.4034, -0.4034],
          [-0.4037, -0.4037, -0.4037,  ..., -0.4038, -0.4037, -0.4037],
          ...,
          [-2.4563, -2.4565, -2.4567,  ..., -2.4556, -2.4558, -2.4560],
          [-2.4443, -2.4444, -2.4445,  ..., -2.4438, -2.4439, -2.4441],
          [-2.4221, -2.4221, -2.4222,  ..., -2.4218, -2.4219, -2.4220]],

         ...,

         [[-0.3455, -0.3455, -0.3455,  ..., -0.3455, -0.3455, -0.3455],
          [-0.4362, -0.4364, -0.4367,  ..., -0.4356, -0.4358, -0.4359],
          [-0.4742, -0.4743, -0.4746,  ..., -0.4738, -0.4740, -0.4740],
          ...,
          [ 1.3454,  1.3454,  1.3453,  ...,  1.3459,  1.3457,  1.3456],
          [ 1.4577,  1.4577,  1.4576,  ...,  1.4580,  1.4578,  1.4578],
          [ 1.4992,  1.4994,  1.4995,  ...,  1.4989,  1.4991,  1.4991]],

         [[ 1.1167,  1.1167,  1.1167,  ...,  1.1167,  1.1167,  1.1167],
          [ 1.0721,  1.0712,  1.0702,  ...,  1.0751,  1.0740,  1.0731],
          [ 1.0931,  1.0924,  1.0916,  ...,  1.0954,  1.0946,  1.0939],
          ...,
          [ 0.8228,  0.8231,  0.8232,  ...,  0.8222,  0.8224,  0.8227],
          [ 1.0827,  1.0821,  1.0819,  ...,  1.0838,  1.0834,  1.0829],
          [ 1.1525,  1.1523,  1.1520,  ...,  1.1534,  1.1531,  1.1528]],

         [[-0.7792, -0.7792, -0.7792,  ..., -0.7792, -0.7792, -0.7792],
          [-0.7819, -0.7819, -0.7819,  ..., -0.7819, -0.7819, -0.7819],
          [-0.7846, -0.7846, -0.7846,  ..., -0.7847, -0.7847, -0.7846],
          ...,
          [-1.1181, -1.1181, -1.1181,  ..., -1.1181, -1.1181, -1.1181],
          [-1.1189, -1.1189, -1.1189,  ..., -1.1189, -1.1189, -1.1189],
          [-1.1200, -1.1200, -1.1200,  ..., -1.1200, -1.1200, -1.1200]]]],
       device='cuda:1')







(Pdb) model(data_slice[0:1])
tensor([[[[ 0.0421,  0.0479,  0.0323,  ..., -0.0080, -0.0226, -0.0165],
          [-0.5468, -0.5408, -0.5330,  ..., -0.5216, -0.5448, -0.5627],
          [-0.5165, -0.4891, -0.4895,  ..., -0.4999, -0.5107, -0.5531],
          ...,
          [-0.1141, -0.1255, -0.1330,  ..., -0.1473, -0.1308, -0.1388],
          [-0.0593, -0.0663, -0.0683,  ..., -0.0870, -0.0637, -0.0559],
          [ 0.0727,  0.0704,  0.0840,  ...,  0.0764,  0.1053,  0.1293]],

         [[-0.0528, -0.0276, -0.0221,  ..., -0.0077, -0.0164, -0.0190],
          [-0.9922, -0.9958, -1.0045,  ..., -0.9817, -0.9820, -0.9728],
          [-0.9830, -1.0042, -1.0218,  ..., -0.9925, -0.9945, -0.9826],
          ...,
          [-1.2409, -1.2539, -1.2155,  ..., -1.2498, -1.2293, -1.2405],
          [-1.3151, -1.3325, -1.3187,  ..., -1.3474, -1.3402, -1.3390],
          [-1.4282, -1.4328, -1.4422,  ..., -1.5242, -1.5267, -1.5156]],

         [[-0.4821, -0.4588, -0.4619,  ..., -0.4359, -0.4454, -0.4513],
          [-0.4465, -0.4502, -0.4433,  ..., -0.4312, -0.4371, -0.4400],
          [-0.4233, -0.4296, -0.4419,  ..., -0.4243, -0.4228, -0.4191],
          ...,
          [-2.4694, -2.4624, -2.4427,  ..., -2.4092, -2.3983, -2.4017],
          [-2.4460, -2.4296, -2.4222,  ..., -2.3841, -2.3828, -2.3839],
          [-2.4177, -2.4051, -2.3993,  ..., -2.3539, -2.3573, -2.3709]],

         ...,

         [[-0.2296, -0.2417, -0.2277,  ..., -0.2413, -0.2348, -0.2165],
          [-0.2203, -0.2261, -0.2260,  ..., -0.1518, -0.1514, -0.1394],
          [-0.0979, -0.1196, -0.1176,  ..., -0.0258, -0.0296, -0.0371],
          ...,
          [ 1.5300,  1.5353,  1.5203,  ...,  1.5108,  1.5028,  1.5411],
          [ 1.5120,  1.5187,  1.5091,  ...,  1.5354,  1.5337,  1.5658],
          [ 1.4906,  1.4860,  1.4929,  ...,  1.5180,  1.5175,  1.5408]],

         [[ 0.9118,  0.8952,  0.8912,  ...,  0.8896,  0.8759,  0.8997],
          [ 0.9016,  0.8923,  0.8827,  ...,  0.9146,  0.9129,  0.9416],
          [ 0.9396,  0.9065,  0.9017,  ...,  0.9241,  0.9327,  0.9675],
          ...,
          [ 0.7309,  0.7312,  0.7299,  ...,  0.6709,  0.6546,  0.6778],
          [ 0.7841,  0.7699,  0.7650,  ...,  0.7611,  0.7379,  0.7457],
          [ 0.8044,  0.8085,  0.8103,  ...,  0.8355,  0.8135,  0.8230]],

         [[-0.7810, -0.7692, -0.7780,  ..., -0.7999, -0.7982, -0.8136],
          [-0.7723, -0.7750, -0.7682,  ..., -0.8050, -0.8104, -0.8108],
          [-0.7743, -0.7810, -0.7875,  ..., -0.8043, -0.7988, -0.7884],
          ...,
          [-1.1077, -1.1161, -1.1078,  ..., -1.1200, -1.1085, -1.1051],
          [-1.1101, -1.1177, -1.1243,  ..., -1.1393, -1.1548, -1.1412],
          [-1.1069, -1.1209, -1.1328,  ..., -1.1395, -1.1437, -1.1497]]]],
       device='cuda:1')


(Pdb) model(data_slice[0:1])
tensor([[[[ -7.6190,  -0.1840,  11.5538,  ...,   8.0322,  -3.7524,   8.4657],
          [  6.4379,   5.6664,  -9.2041,  ...,   5.4451,   9.7375,   8.7749],
          [-12.5302,  -8.5432,  -2.0176,  ...,  13.5126,  -0.3314,  -1.9045],
          ...,
          [  5.2569,   6.6860,   3.4575,  ...,  -9.2148,  -0.7473,  -1.1643],
          [  3.4418,  -5.0369,  12.0660,  ...,   3.2866,  -3.3262,  -3.2772],
          [ -2.2158,  15.5935,   7.9789,  ...,  10.1436,  -1.2337,  14.0688]],

         [[  4.1119,   2.2119,   7.0259,  ...,   8.6836, -12.0619,  -2.6581],
          [ 15.4184, -11.4427,  -1.7377,  ...,  -8.4477,   5.9497,  11.7040],
          [ -3.8656,  -0.2379,   2.8854,  ...,  -4.2116,   6.5963,   4.0215],
          ...,
          [ -8.1430,  -6.9176,  -1.1821,  ...,  -4.2140,  16.3196,  -3.1850],
          [ -1.2936,  -0.2545,   5.3804,  ...,  -0.6189,   5.2967,   2.5092],
          [ -6.9685,  -2.3678,  -4.6970,  ...,   3.9775,   0.9380,  -0.8112]],

         [[ -9.2684,   3.5066,  -1.0553,  ...,   5.7179,   4.9328,   1.5704],
          [ -3.8492,   2.0506,  -5.7846,  ...,  -3.7487,  -0.3962,   1.3095],
          [ -9.1661,   6.9968,  -8.5387,  ...,  -0.5958,   1.6899,  -7.4807],
          ...,
          [ -7.4240,  10.0226,  -6.4051,  ...,  -0.9550,   4.9526,  -9.6167],
          [  1.5035,  -2.3202,  -5.9843,  ...,  -0.0663,  -6.4532,  -0.6983],
          [ -2.2455, -11.5943,  13.7957,  ...,  11.4995,  -2.4567,   6.1279]],

         ...,

         [[  8.7865,  14.7034,  -4.5203,  ...,  -5.1311,  -2.4492,  -5.7062],
          [ -3.9562,  -1.8940,  -7.8182,  ...,   9.1588,   9.2190,  -0.8033],
          [ -0.7713,   2.4966,  11.4385,  ...,  -2.6082,   7.0997,  10.2035],
          ...,
          [  4.7720,  -4.6457,   3.3711,  ...,   4.1496,  17.3588, -11.3686],
          [-14.6036,  -3.4820,   8.9109,  ...,  -0.2074,   2.6685,  -0.1220],
          [  6.5604,  -4.1247,  -0.5430,  ..., -10.1126,  -0.1031,  12.6735]],

         [[ -2.4455,  10.3587,   4.2338,  ...,   4.5350,  -3.1760,   5.0473],
          [ -3.9726, -11.6040,   3.2215,  ...,   1.2236,   5.2702,  -4.1844],
          [ -8.1575,  -3.9072,   2.7374,  ..., -17.9594,  -3.5811,  12.1807],
          ...,
          [-11.6759,   3.8214,   1.6632,  ...,  -5.0783,  -1.9070,   4.3694],
          [ -1.6749,   1.1669,  -0.7947,  ...,   6.4073,  -1.0351,   2.1715],
          [  3.2424,  13.0369,  -2.5740,  ...,   2.3729,  -7.9224, -16.2727]],

         [[-14.4565,   5.5591, -10.1666,  ...,   5.3791,  -0.7983, -10.4905],
          [-22.1011,   0.5947,  20.9617,  ...,   5.4715,  -8.6341,  11.7901],
          [  1.3200, -16.5490,  10.4140,  ...,  -0.4215,   3.7637, -10.3145],
          ...,
          [  0.7374,  -4.2234,  -3.6249,  ...,   1.9831,  -1.4112,   0.2624],
          [  5.0181,  11.0852,  -7.3470,  ...,   7.9361,   7.8985,  -7.3152],
          [ -2.9438,  -6.6220,  -1.3803,  ...,  -2.2411,  -1.2198,   2.1835]]]],
       device='cuda:3')





####### Modular 

tensor([[[[ -7.2515,  -0.1400,   7.3177,  ...,   8.7924,  -1.3555,   4.3597],
          [  0.4319,   2.4766,  -0.0698,  ...,  13.5199,   0.2049,  -3.5701],
          [  0.0883,   7.5780,  12.2003,  ...,  -3.3590,   7.3450,   4.2277],
          ...,
          [  1.0312,   1.2661,   1.0749,  ...,   3.0698,  -1.2421,   6.9719],
          [ -7.3282,  -4.6107,  -2.8243,  ...,   9.6637,  -0.9828,   9.8924],
          [ 12.8678, -10.5131,   1.2623,  ...,  -5.0439,  -5.1797,  -3.0161]],

         [[  8.1797, -10.1193,  -4.7626,  ...,   1.1768,  -1.0958,  -8.8352],
          [-11.0402,   3.9602,  11.3742,  ...,   7.0746, -11.5483,   8.4987],
          [  3.2136,  -1.2783,  -4.1022,  ..., -11.0036,  12.4397,   8.7358],
          ...,
          [-14.6057,   7.2931,  -0.3443,  ...,  -5.6436,  -6.3621,   3.2165],
          [ 10.5242,  11.0984,   7.4832,  ...,  11.9876,  12.9097,  -3.0138],
          [-10.9972,  -6.5615,   3.1062,  ..., -11.6235,   0.9821,   2.0459]],

         [[  2.5062,   3.9060,   9.1610,  ...,  18.4665,   7.0862,   3.3385],
          [ -5.9616,  -9.8468,   7.3225,  ...,   2.1795,  -3.9177,   4.7842],
          [  1.8575,  -5.5697,  -8.6593,  ...,  11.3519, -10.0067,  -0.3323],
          ...,
          [ 14.0069,  -2.3091,   5.1272,  ...,  -4.3892,   2.5271,   1.5103],
          [  0.3980,  -0.5598,  -4.2986,  ...,  -1.2713,  -0.7215,  -0.4744],
          [ -3.3576,   6.7027,  -4.3113,  ...,  -6.5514,  -5.7756,  -2.7390]],

         ...,

         [[  7.8597,  10.4865,  17.1969,  ..., -18.6456, -10.0755,  -2.2522],
          [-10.8981,  -1.9873, -11.2590,  ...,  -4.3217,  -6.0122,  -4.9828],
          [  8.2828,   3.2300,  -5.5581,  ...,  -3.5657,  -1.5152,  -1.4611],
          ...,
          [  1.5444,   6.1888,   1.4856,  ...,  -9.7788, -17.4333,  -0.2842],
          [  1.1943,  -4.9744,   0.1317,  ...,   7.1756,  -5.6480,   0.7296],
          [ -5.4521,  -4.3089,   7.7606,  ...,   0.4464,   6.3324,   3.3320]],

         [[ -7.9955, -10.8494,  13.6522,  ...,  12.2145,   7.2985,   4.3089],
          [ -7.4507,   2.0473,  -1.7225,  ...,  -4.2487,   9.2446,   1.2078],
          [ -9.4951,   7.1329,   3.5399,  ...,   5.0428,  -0.5131,  -1.6789],
          ...,
          [  5.3666,  -9.5917,   1.1717,  ...,  12.0846,   6.6783,  -9.6720],
          [  4.0557,   6.8401,  -1.7527,  ...,  -7.7349,  -0.1921,  -7.8699],
          [  8.0149, -11.6959,  -7.7036,  ...,   6.7744,   5.7000,  15.6475]],

         [[ -2.4245,  -1.0117,  -4.4534,  ...,   6.8910,   9.1362,  -4.5743],
          [ -2.0828,  -7.5747, -17.2983,  ...,  -3.8595,   2.7940,  10.9176],
          [  5.1178,   7.1073,   5.8470,  ...,  -2.3924,   1.9476,   2.0236],
          ...,
          [-11.1570,  11.1678,   1.8727,  ...,   1.2456,  -9.2022,   0.6649],
          [ -8.9910,  -8.7133, -11.0115,  ...,  -5.4697,   3.1730,  -2.8239],
          [  2.2301,  12.2764,   0.9696,  ...,  -4.9389,   1.2753,  -4.1089]]],


        [[[ -7.2515,  -0.1400,   7.3177,  ...,   8.7924,  -1.3555,   4.3597],
          [  0.4319,   2.4766,  -0.0698,  ...,  13.5199,   0.2049,  -3.5701],
          [  0.0883,   7.5780,  12.2003,  ...,  -3.3590,   7.3450,   4.2277],
          ...,
          [  1.0312,   1.2661,   1.0749,  ...,   3.0698,  -1.2421,   6.9719],
          [ -7.3282,  -4.6107,  -2.8243,  ...,   9.6637,  -0.9828,   9.8924],
          [ 12.8678, -10.5131,   1.2623,  ...,  -5.0439,  -5.1797,  -3.0161]],

         [[  8.1797, -10.1193,  -4.7626,  ...,   1.1768,  -1.0958,  -8.8352],
          [-11.0402,   3.9602,  11.3742,  ...,   7.0746, -11.5483,   8.4987],
          [  3.2136,  -1.2783,  -4.1022,  ..., -11.0036,  12.4397,   8.7358],
          ...,
          [-14.6057,   7.2931,  -0.3443,  ...,  -5.6436,  -6.3621,   3.2165],
          [ 10.5242,  11.0984,   7.4832,  ...,  11.9876,  12.9097,  -3.0138],
          [-10.9972,  -6.5615,   3.1062,  ..., -11.6235,   0.9821,   2.0459]],

         [[  2.5062,   3.9060,   9.1610,  ...,  18.4665,   7.0862,   3.3385],
          [ -5.9616,  -9.8468,   7.3225,  ...,   2.1795,  -3.9177,   4.7842],
          [  1.8575,  -5.5697,  -8.6593,  ...,  11.3519, -10.0067,  -0.3323],
          ...,
          [ 14.0069,  -2.3091,   5.1272,  ...,  -4.3892,   2.5271,   1.5103],
          [  0.3980,  -0.5598,  -4.2986,  ...,  -1.2713,  -0.7215,  -0.4744],
          [ -3.3576,   6.7027,  -4.3113,  ...,  -6.5514,  -5.7756,  -2.7390]],

         ...,

         [[  7.8597,  10.4865,  17.1969,  ..., -18.6456, -10.0755,  -2.2522],
          [-10.8981,  -1.9873, -11.2590,  ...,  -4.3217,  -6.0122,  -4.9828],
          [  8.2828,   3.2300,  -5.5581,  ...,  -3.5657,  -1.5152,  -1.4611],
          ...,
          [  1.5444,   6.1888,   1.4856,  ...,  -9.7788, -17.4333,  -0.2842],
          [  1.1943,  -4.9744,   0.1317,  ...,   7.1756,  -5.6480,   0.7296],
          [ -5.4521,  -4.3089,   7.7606,  ...,   0.4464,   6.3324,   3.3320]],

         [[ -7.9955, -10.8494,  13.6522,  ...,  12.2145,   7.2985,   4.3089],
          [ -7.4507,   2.0473,  -1.7225,  ...,  -4.2487,   9.2446,   1.2078],
          [ -9.4951,   7.1329,   3.5399,  ...,   5.0428,  -0.5131,  -1.6789],
          ...,
          [  5.3666,  -9.5917,   1.1717,  ...,  12.0846,   6.6783,  -9.6720],
          [  4.0557,   6.8401,  -1.7527,  ...,  -7.7349,  -0.1921,  -7.8699],
          [  8.0149, -11.6959,  -7.7036,  ...,   6.7744,   5.7000,  15.6475]],

         [[ -2.4245,  -1.0117,  -4.4534,  ...,   6.8910,   9.1362,  -4.5743],
          [ -2.0828,  -7.5747, -17.2983,  ...,  -3.8595,   2.7940,  10.9176],
          [  5.1178,   7.1073,   5.8470,  ...,  -2.3924,   1.9476,   2.0236],
          ...,
          [-11.1570,  11.1678,   1.8727,  ...,   1.2456,  -9.2022,   0.6649],
          [ -8.9910,  -8.7133, -11.0115,  ...,  -5.4697,   3.1730,  -2.8239],
          [  2.2301,  12.2764,   0.9696,  ...,  -4.9389,   1.2753,  -4.1089]]],


        [[[ -7.2515,  -0.1400,   7.3177,  ...,   8.7924,  -1.3555,   4.3597],
          [  0.4319,   2.4766,  -0.0698,  ...,  13.5199,   0.2049,  -3.5701],
          [  0.0883,   7.5780,  12.2003,  ...,  -3.3590,   7.3450,   4.2277],
          ...,
          [  1.0312,   1.2661,   1.0749,  ...,   3.0698,  -1.2421,   6.9719],
          [ -7.3282,  -4.6107,  -2.8243,  ...,   9.6637,  -0.9828,   9.8924],
          [ 12.8678, -10.5131,   1.2623,  ...,  -5.0439,  -5.1797,  -3.0161]],

         [[  8.1797, -10.1193,  -4.7626,  ...,   1.1768,  -1.0958,  -8.8352],
          [-11.0402,   3.9602,  11.3742,  ...,   7.0746, -11.5483,   8.4987],
          [  3.2136,  -1.2783,  -4.1022,  ..., -11.0036,  12.4397,   8.7358],
          ...,
          [-14.6057,   7.2931,  -0.3443,  ...,  -5.6436,  -6.3621,   3.2165],
          [ 10.5242,  11.0984,   7.4832,  ...,  11.9876,  12.9097,  -3.0138],
          [-10.9972,  -6.5615,   3.1062,  ..., -11.6235,   0.9821,   2.0459]],

         [[  2.5062,   3.9060,   9.1610,  ...,  18.4665,   7.0862,   3.3385],
          [ -5.9616,  -9.8468,   7.3225,  ...,   2.1795,  -3.9177,   4.7842],
          [  1.8575,  -5.5697,  -8.6593,  ...,  11.3519, -10.0067,  -0.3323],
          ...,
          [ 14.0069,  -2.3091,   5.1272,  ...,  -4.3892,   2.5271,   1.5103],
          [  0.3980,  -0.5598,  -4.2986,  ...,  -1.2713,  -0.7215,  -0.4744],
          [ -3.3576,   6.7027,  -4.3113,  ...,  -6.5514,  -5.7756,  -2.7390]],

         ...,

         [[  7.8597,  10.4865,  17.1969,  ..., -18.6456, -10.0755,  -2.2522],
          [-10.8981,  -1.9873, -11.2590,  ...,  -4.3217,  -6.0122,  -4.9828],
          [  8.2828,   3.2300,  -5.5581,  ...,  -3.5657,  -1.5152,  -1.4611],
          ...,
          [  1.5444,   6.1888,   1.4856,  ...,  -9.7788, -17.4333,  -0.2842],
          [  1.1943,  -4.9744,   0.1317,  ...,   7.1756,  -5.6480,   0.7296],
          [ -5.4521,  -4.3089,   7.7606,  ...,   0.4464,   6.3324,   3.3320]],

         [[ -7.9955, -10.8494,  13.6522,  ...,  12.2145,   7.2985,   4.3089],
          [ -7.4507,   2.0473,  -1.7225,  ...,  -4.2487,   9.2446,   1.2078],
          [ -9.4951,   7.1329,   3.5399,  ...,   5.0428,  -0.5131,  -1.6789],
          ...,
          [  5.3666,  -9.5917,   1.1717,  ...,  12.0846,   6.6783,  -9.6720],
          [  4.0557,   6.8401,  -1.7527,  ...,  -7.7349,  -0.1921,  -7.8699],
          [  8.0149, -11.6959,  -7.7036,  ...,   6.7744,   5.7000,  15.6475]],

         [[ -2.4245,  -1.0117,  -4.4534,  ...,   6.8910,   9.1362,  -4.5743],
          [ -2.0828,  -7.5747, -17.2983,  ...,  -3.8595,   2.7940,  10.9176],
          [  5.1178,   7.1073,   5.8470,  ...,  -2.3924,   1.9476,   2.0236],
          ...,
          [-11.1570,  11.1678,   1.8727,  ...,   1.2456,  -9.2022,   0.6649],
          [ -8.9910,  -8.7133, -11.0115,  ...,  -5.4697,   3.1730,  -2.8239],
          [  2.2301,  12.2764,   0.9696,  ...,  -4.9389,   1.2753,  -4.1089]]],


        ...,


        [[[ -7.2515,  -0.1400,   7.3177,  ...,   8.7924,  -1.3555,   4.3597],
          [  0.4319,   2.4766,  -0.0698,  ...,  13.5199,   0.2049,  -3.5701],
          [  0.0883,   7.5780,  12.2003,  ...,  -3.3590,   7.3450,   4.2277],
          ...,
          [  1.0312,   1.2661,   1.0749,  ...,   3.0698,  -1.2421,   6.9719],
          [ -7.3282,  -4.6107,  -2.8243,  ...,   9.6637,  -0.9828,   9.8924],
          [ 12.8678, -10.5131,   1.2623,  ...,  -5.0439,  -5.1797,  -3.0161]],

         [[  8.1797, -10.1193,  -4.7626,  ...,   1.1768,  -1.0958,  -8.8352],
          [-11.0402,   3.9602,  11.3742,  ...,   7.0746, -11.5483,   8.4987],
          [  3.2136,  -1.2783,  -4.1022,  ..., -11.0036,  12.4397,   8.7358],
          ...,
          [-14.6057,   7.2931,  -0.3443,  ...,  -5.6436,  -6.3621,   3.2165],
          [ 10.5242,  11.0984,   7.4832,  ...,  11.9876,  12.9097,  -3.0138],
          [-10.9972,  -6.5615,   3.1062,  ..., -11.6235,   0.9821,   2.0459]],

         [[  2.5062,   3.9060,   9.1610,  ...,  18.4665,   7.0862,   3.3385],
          [ -5.9616,  -9.8468,   7.3225,  ...,   2.1795,  -3.9177,   4.7842],
          [  1.8575,  -5.5697,  -8.6593,  ...,  11.3519, -10.0067,  -0.3323],
          ...,
          [ 14.0069,  -2.3091,   5.1272,  ...,  -4.3892,   2.5271,   1.5103],
          [  0.3980,  -0.5598,  -4.2986,  ...,  -1.2713,  -0.7215,  -0.4744],
          [ -3.3576,   6.7027,  -4.3113,  ...,  -6.5514,  -5.7756,  -2.7390]],

         ...,

         [[  7.8597,  10.4865,  17.1969,  ..., -18.6456, -10.0755,  -2.2522],
          [-10.8981,  -1.9873, -11.2590,  ...,  -4.3217,  -6.0122,  -4.9828],
          [  8.2828,   3.2300,  -5.5581,  ...,  -3.5657,  -1.5152,  -1.4611],
          ...,
          [  1.5444,   6.1888,   1.4856,  ...,  -9.7788, -17.4333,  -0.2842],
          [  1.1943,  -4.9744,   0.1317,  ...,   7.1756,  -5.6480,   0.7296],
          [ -5.4521,  -4.3089,   7.7606,  ...,   0.4464,   6.3324,   3.3320]],

         [[ -7.9955, -10.8494,  13.6522,  ...,  12.2145,   7.2985,   4.3089],
          [ -7.4507,   2.0473,  -1.7225,  ...,  -4.2487,   9.2446,   1.2078],
          [ -9.4951,   7.1329,   3.5399,  ...,   5.0428,  -0.5131,  -1.6789],
          ...,
          [  5.3666,  -9.5917,   1.1717,  ...,  12.0846,   6.6783,  -9.6720],
          [  4.0557,   6.8401,  -1.7527,  ...,  -7.7349,  -0.1921,  -7.8699],
          [  8.0149, -11.6959,  -7.7036,  ...,   6.7744,   5.7000,  15.6475]],

         [[ -2.4245,  -1.0117,  -4.4534,  ...,   6.8910,   9.1362,  -4.5743],
          [ -2.0828,  -7.5747, -17.2983,  ...,  -3.8595,   2.7940,  10.9176],
          [  5.1178,   7.1073,   5.8470,  ...,  -2.3924,   1.9476,   2.0236],
          ...,
          [-11.1570,  11.1678,   1.8727,  ...,   1.2456,  -9.2022,   0.6649],
          [ -8.9910,  -8.7133, -11.0115,  ...,  -5.4697,   3.1730,  -2.8239],
          [  2.2301,  12.2764,   0.9696,  ...,  -4.9389,   1.2753,  -4.1089]]],


        [[[ -7.2515,  -0.1400,   7.3177,  ...,   8.7924,  -1.3555,   4.3597],
          [  0.4319,   2.4766,  -0.0698,  ...,  13.5199,   0.2049,  -3.5701],
          [  0.0883,   7.5780,  12.2003,  ...,  -3.3590,   7.3450,   4.2277],
          ...,
          [  1.0312,   1.2661,   1.0749,  ...,   3.0698,  -1.2421,   6.9719],
          [ -7.3282,  -4.6107,  -2.8243,  ...,   9.6637,  -0.9828,   9.8924],
          [ 12.8678, -10.5131,   1.2623,  ...,  -5.0439,  -5.1797,  -3.0161]],

         [[  8.1797, -10.1193,  -4.7626,  ...,   1.1768,  -1.0958,  -8.8352],
          [-11.0402,   3.9602,  11.3742,  ...,   7.0746, -11.5483,   8.4987],
          [  3.2136,  -1.2783,  -4.1022,  ..., -11.0036,  12.4397,   8.7358],
          ...,
          [-14.6057,   7.2931,  -0.3443,  ...,  -5.6436,  -6.3621,   3.2165],
          [ 10.5242,  11.0984,   7.4832,  ...,  11.9876,  12.9097,  -3.0138],
          [-10.9972,  -6.5615,   3.1062,  ..., -11.6235,   0.9821,   2.0459]],

         [[  2.5062,   3.9060,   9.1610,  ...,  18.4665,   7.0862,   3.3385],
          [ -5.9616,  -9.8468,   7.3225,  ...,   2.1795,  -3.9177,   4.7842],
          [  1.8575,  -5.5697,  -8.6593,  ...,  11.3519, -10.0067,  -0.3323],
          ...,
          [ 14.0069,  -2.3091,   5.1272,  ...,  -4.3892,   2.5271,   1.5103],
          [  0.3980,  -0.5598,  -4.2986,  ...,  -1.2713,  -0.7215,  -0.4744],
          [ -3.3576,   6.7027,  -4.3113,  ...,  -6.5514,  -5.7756,  -2.7390]],

         ...,

         [[  7.8597,  10.4865,  17.1969,  ..., -18.6456, -10.0755,  -2.2522],
          [-10.8981,  -1.9873, -11.2590,  ...,  -4.3217,  -6.0122,  -4.9828],
          [  8.2828,   3.2300,  -5.5581,  ...,  -3.5657,  -1.5152,  -1.4611],
          ...,
          [  1.5444,   6.1888,   1.4856,  ...,  -9.7788, -17.4333,  -0.2842],
          [  1.1943,  -4.9744,   0.1317,  ...,   7.1756,  -5.6480,   0.7296],
          [ -5.4521,  -4.3089,   7.7606,  ...,   0.4464,   6.3324,   3.3320]],

         [[ -7.9955, -10.8494,  13.6522,  ...,  12.2145,   7.2985,   4.3089],
          [ -7.4507,   2.0473,  -1.7225,  ...,  -4.2487,   9.2446,   1.2078],
          [ -9.4951,   7.1329,   3.5399,  ...,   5.0428,  -0.5131,  -1.6789],
          ...,
          [  5.3666,  -9.5917,   1.1717,  ...,  12.0846,   6.6783,  -9.6720],
          [  4.0557,   6.8401,  -1.7527,  ...,  -7.7349,  -0.1921,  -7.8699],
          [  8.0149, -11.6959,  -7.7036,  ...,   6.7744,   5.7000,  15.6475]],

         [[ -2.4245,  -1.0117,  -4.4534,  ...,   6.8910,   9.1362,  -4.5743],
          [ -2.0828,  -7.5747, -17.2983,  ...,  -3.8595,   2.7940,  10.9176],
          [  5.1178,   7.1073,   5.8470,  ...,  -2.3924,   1.9476,   2.0236],
          ...,
          [-11.1570,  11.1678,   1.8727,  ...,   1.2456,  -9.2022,   0.6649],
          [ -8.9910,  -8.7133, -11.0115,  ...,  -5.4697,   3.1730,  -2.8239],
          [  2.2301,  12.2764,   0.9696,  ...,  -4.9389,   1.2753,  -4.1089]]],


        [[[ -7.2515,  -0.1400,   7.3177,  ...,   8.7924,  -1.3555,   4.3597],
          [  0.4319,   2.4766,  -0.0698,  ...,  13.5199,   0.2049,  -3.5701],
          [  0.0883,   7.5780,  12.2003,  ...,  -3.3590,   7.3450,   4.2277],
          ...,
          [  1.0312,   1.2661,   1.0749,  ...,   3.0698,  -1.2421,   6.9719],
          [ -7.3282,  -4.6107,  -2.8243,  ...,   9.6637,  -0.9828,   9.8924],
          [ 12.8678, -10.5131,   1.2623,  ...,  -5.0439,  -5.1797,  -3.0161]],

         [[  8.1797, -10.1193,  -4.7626,  ...,   1.1768,  -1.0958,  -8.8352],
          [-11.0402,   3.9602,  11.3742,  ...,   7.0746, -11.5483,   8.4987],
          [  3.2136,  -1.2783,  -4.1022,  ..., -11.0036,  12.4397,   8.7358],
          ...,
          [-14.6057,   7.2931,  -0.3443,  ...,  -5.6436,  -6.3621,   3.2165],
          [ 10.5242,  11.0984,   7.4832,  ...,  11.9876,  12.9097,  -3.0138],
          [-10.9972,  -6.5615,   3.1062,  ..., -11.6235,   0.9821,   2.0459]],

         [[  2.5062,   3.9060,   9.1610,  ...,  18.4665,   7.0862,   3.3385],
          [ -5.9616,  -9.8468,   7.3225,  ...,   2.1795,  -3.9177,   4.7842],
          [  1.8575,  -5.5697,  -8.6593,  ...,  11.3519, -10.0067,  -0.3323],
          ...,
          [ 14.0069,  -2.3091,   5.1272,  ...,  -4.3892,   2.5271,   1.5103],
          [  0.3980,  -0.5598,  -4.2986,  ...,  -1.2713,  -0.7215,  -0.4744],
          [ -3.3576,   6.7027,  -4.3113,  ...,  -6.5514,  -5.7756,  -2.7390]],

         ...,

         [[  7.8597,  10.4865,  17.1969,  ..., -18.6456, -10.0755,  -2.2522],
          [-10.8981,  -1.9873, -11.2590,  ...,  -4.3217,  -6.0122,  -4.9828],
          [  8.2828,   3.2300,  -5.5581,  ...,  -3.5657,  -1.5152,  -1.4611],
          ...,
          [  1.5444,   6.1888,   1.4856,  ...,  -9.7788, -17.4333,  -0.2842],
          [  1.1943,  -4.9744,   0.1317,  ...,   7.1756,  -5.6480,   0.7296],
          [ -5.4521,  -4.3089,   7.7606,  ...,   0.4464,   6.3324,   3.3320]],

         [[ -7.9955, -10.8494,  13.6522,  ...,  12.2145,   7.2985,   4.3089],
          [ -7.4507,   2.0473,  -1.7225,  ...,  -4.2487,   9.2446,   1.2078],
          [ -9.4951,   7.1329,   3.5399,  ...,   5.0428,  -0.5131,  -1.6789],
          ...,
          [  5.3666,  -9.5917,   1.1717,  ...,  12.0846,   6.6783,  -9.6720],
          [  4.0557,   6.8401,  -1.7527,  ...,  -7.7349,  -0.1921,  -7.8699],
          [  8.0149, -11.6959,  -7.7036,  ...,   6.7744,   5.7000,  15.6475]],

         [[ -2.4245,  -1.0117,  -4.4534,  ...,   6.8910,   9.1362,  -4.5743],
          [ -2.0828,  -7.5747, -17.2983,  ...,  -3.8595,   2.7940,  10.9176],
          [  5.1178,   7.1073,   5.8470,  ...,  -2.3924,   1.9476,   2.0236],
          ...,
          [-11.1570,  11.1678,   1.8727,  ...,   1.2456,  -9.2022,   0.6649],
          [ -8.9910,  -8.7133, -11.0115,  ...,  -5.4697,   3.1730,  -2.8239],
          [  2.2301,  12.2764,   0.9696,  ...,  -4.9389,   1.2753,  -4.1089]]]],
       device='cuda:3')


#### Non- modular


tensor([[[[-1.4970e+00, -6.8642e-01,  2.2158e-01,  ..., -1.7119e+00,
           -6.0402e-01,  1.0469e+00],
          [-1.1483e+00, -7.8772e-01, -5.9597e-01,  ..., -2.2653e+00,
           -1.2476e+00,  8.6835e-02],
          [-1.3815e+00, -1.3616e+00, -1.5167e+00,  ..., -2.0027e+00,
           -1.7034e+00, -1.3109e+00],
          ...,
          [-4.7387e+00, -7.3059e+00, -7.1722e+00,  ..., -8.6522e-01,
           -2.6967e+00,  2.1557e+00],
          [-1.3428e+01, -1.4029e+01, -1.3220e+01,  ..., -9.1253e+00,
           -6.7455e+00,  1.8294e+00],
          [-4.1635e+00,  1.6244e+00,  4.5459e+00,  ..., -1.2377e+01,
           -1.0201e+01, -4.7399e+00]],

         [[ 8.6304e-01,  6.2800e-01, -1.5441e-01,  ..., -1.3847e+00,
           -2.2171e+00, -3.5031e+00],
          [-1.2124e+00, -2.0566e+00, -2.7273e+00,  ..., -2.4875e+00,
           -3.5766e+00, -4.6983e+00],
          [-1.7556e+00, -2.9772e+00, -3.8154e+00,  ..., -2.0966e+00,
           -3.0938e+00, -4.0337e+00],
          ...,
          [-1.1778e+01, -1.8214e+01, -2.5555e+01,  ..., -8.2810e+00,
           -2.6046e+00, -5.4866e+00],
          [-3.7799e+01, -3.4560e+01, -4.0341e+01,  ..., -6.0459e+00,
            1.4189e+00, -2.4803e+00],
          [-5.1292e+01, -3.8012e+01, -3.2760e+01,  ..., -3.2384e+00,
           -5.0503e-01, -5.1603e+00]],

         [[ 3.1438e+00,  2.6887e+00,  2.4818e+00,  ...,  1.1686e+00,
            8.8895e-01,  9.5541e-01],
          [ 3.1794e+00,  2.6159e+00,  2.1458e+00,  ...,  1.0078e+00,
            6.1526e-01,  7.5839e-01],
          [ 2.5773e+00,  2.1888e+00,  1.7769e+00,  ...,  1.1280e+00,
            1.1905e+00,  1.3865e+00],
          ...,
          [ 1.7951e+01,  1.7200e+01,  1.8628e+01,  ...,  1.1115e+01,
            1.0923e+01,  1.2843e+01],
          [ 2.0482e+01,  2.2945e+01,  2.2010e+01,  ...,  1.1056e+01,
            1.0480e+01,  1.0945e+01],
          [ 2.5077e+01,  2.5552e+01,  2.2253e+01,  ...,  1.1297e+01,
            1.0878e+01,  1.1680e+01]],

         ...,

         [[ 4.2637e+00,  2.3285e+00,  5.2340e-01,  ...,  2.8999e+00,
            2.6085e+00,  1.9601e+00],
          [ 2.9124e+00,  1.1603e+00, -4.2039e-01,  ...,  2.1897e+00,
            2.6458e+00,  2.6852e+00],
          [ 2.8930e+00,  1.4178e+00,  5.4209e-02,  ...,  3.0047e+00,
            3.8600e+00,  4.3336e+00],
          ...,
          [ 1.9211e+01,  2.0125e+01,  2.2063e+01,  ...,  8.2092e+00,
            9.4873e+00,  6.7884e+00],
          [ 1.7132e+01,  2.4904e+01,  3.2191e+01,  ...,  6.3512e+00,
            4.2504e+00,  1.6820e+00],
          [ 1.1643e+01,  2.2879e+01,  3.3736e+01,  ...,  7.6160e+00,
            2.8478e+00, -2.8665e-01]],

         [[-3.7880e+00, -5.3146e+00, -5.9722e+00,  ...,  6.7997e+00,
            8.8110e+00,  9.1189e+00],
          [-4.4077e+00, -5.5966e+00, -6.1416e+00,  ...,  6.0067e+00,
            9.0471e+00,  9.8382e+00],
          [-1.9604e+00, -3.0933e+00, -3.7578e+00,  ...,  3.0881e+00,
            6.4858e+00,  7.6439e+00],
          ...,
          [-1.6268e+01, -9.4121e+00,  3.8563e+00,  ..., -4.7626e+00,
           -3.3485e-01, -2.1426e+00],
          [-2.6746e+01, -9.8711e+00,  1.9501e+01,  ...,  1.7245e+01,
            1.5484e+00, -1.3040e+01],
          [-1.9614e+01,  9.2935e+00,  4.7061e+01,  ...,  2.8261e+01,
            4.7712e-01, -2.2819e+01]],

         [[ 2.4914e+00,  2.5552e+00,  3.1902e+00,  ...,  4.0246e+00,
            4.2004e+00,  4.5936e+00],
          [ 2.5527e+00,  2.4664e+00,  2.6745e+00,  ...,  3.7322e+00,
            3.9465e+00,  4.7251e+00],
          [ 3.0034e+00,  2.5656e+00,  2.1343e+00,  ...,  2.8397e+00,
            3.7285e+00,  4.4659e+00],
          ...,
          [ 7.3927e+01,  6.8701e+01,  6.0577e+01,  ...,  2.9624e+01,
            2.5882e+01,  2.3594e+01],
          [ 6.6480e+01,  6.5936e+01,  6.1619e+01,  ...,  2.7881e+01,
            2.0574e+01,  1.5568e+01],
          [ 5.6905e+01,  5.6462e+01,  5.4476e+01,  ...,  2.4134e+01,
            1.9404e+01,  1.2735e+01]]],


        [[[-1.4970e+00, -6.8642e-01,  2.2158e-01,  ..., -1.7119e+00,
           -6.0402e-01,  1.0469e+00],
          [-1.1483e+00, -7.8772e-01, -5.9597e-01,  ..., -2.2653e+00,
           -1.2476e+00,  8.6835e-02],
          [-1.3815e+00, -1.3616e+00, -1.5167e+00,  ..., -2.0027e+00,
           -1.7034e+00, -1.3109e+00],
          ...,
          [-4.7387e+00, -7.3059e+00, -7.1722e+00,  ..., -8.6522e-01,
           -2.6967e+00,  2.1557e+00],
          [-1.3428e+01, -1.4029e+01, -1.3220e+01,  ..., -9.1253e+00,
           -6.7455e+00,  1.8294e+00],
          [-4.1635e+00,  1.6244e+00,  4.5459e+00,  ..., -1.2377e+01,
           -1.0201e+01, -4.7399e+00]],

         [[ 8.6304e-01,  6.2800e-01, -1.5441e-01,  ..., -1.3847e+00,
           -2.2171e+00, -3.5031e+00],
          [-1.2124e+00, -2.0566e+00, -2.7273e+00,  ..., -2.4875e+00,
           -3.5766e+00, -4.6983e+00],
          [-1.7556e+00, -2.9772e+00, -3.8154e+00,  ..., -2.0966e+00,
           -3.0938e+00, -4.0337e+00],
          ...,
          [-1.1778e+01, -1.8214e+01, -2.5555e+01,  ..., -8.2810e+00,
           -2.6046e+00, -5.4866e+00],
          [-3.7799e+01, -3.4560e+01, -4.0341e+01,  ..., -6.0459e+00,
            1.4189e+00, -2.4803e+00],
          [-5.1292e+01, -3.8012e+01, -3.2760e+01,  ..., -3.2384e+00,
           -5.0503e-01, -5.1603e+00]],

         [[ 3.1438e+00,  2.6887e+00,  2.4818e+00,  ...,  1.1686e+00,
            8.8895e-01,  9.5541e-01],
          [ 3.1794e+00,  2.6159e+00,  2.1458e+00,  ...,  1.0078e+00,
            6.1526e-01,  7.5839e-01],
          [ 2.5773e+00,  2.1888e+00,  1.7769e+00,  ...,  1.1280e+00,
            1.1905e+00,  1.3865e+00],
          ...,
          [ 1.7951e+01,  1.7200e+01,  1.8628e+01,  ...,  1.1115e+01,
            1.0923e+01,  1.2843e+01],
          [ 2.0482e+01,  2.2945e+01,  2.2010e+01,  ...,  1.1056e+01,
            1.0480e+01,  1.0945e+01],
          [ 2.5077e+01,  2.5552e+01,  2.2253e+01,  ...,  1.1297e+01,
            1.0878e+01,  1.1680e+01]],

         ...,

         [[ 4.2637e+00,  2.3285e+00,  5.2340e-01,  ...,  2.8999e+00,
            2.6085e+00,  1.9601e+00],
          [ 2.9124e+00,  1.1603e+00, -4.2039e-01,  ...,  2.1897e+00,
            2.6458e+00,  2.6852e+00],
          [ 2.8930e+00,  1.4178e+00,  5.4209e-02,  ...,  3.0047e+00,
            3.8600e+00,  4.3336e+00],
          ...,
          [ 1.9211e+01,  2.0125e+01,  2.2063e+01,  ...,  8.2092e+00,
            9.4873e+00,  6.7884e+00],
          [ 1.7132e+01,  2.4904e+01,  3.2191e+01,  ...,  6.3512e+00,
            4.2504e+00,  1.6820e+00],
          [ 1.1643e+01,  2.2879e+01,  3.3736e+01,  ...,  7.6160e+00,
            2.8478e+00, -2.8665e-01]],

         [[-3.7880e+00, -5.3146e+00, -5.9722e+00,  ...,  6.7997e+00,
            8.8110e+00,  9.1189e+00],
          [-4.4077e+00, -5.5966e+00, -6.1416e+00,  ...,  6.0067e+00,
            9.0471e+00,  9.8382e+00],
          [-1.9604e+00, -3.0933e+00, -3.7578e+00,  ...,  3.0881e+00,
            6.4858e+00,  7.6439e+00],
          ...,
          [-1.6268e+01, -9.4121e+00,  3.8563e+00,  ..., -4.7626e+00,
           -3.3485e-01, -2.1426e+00],
          [-2.6746e+01, -9.8711e+00,  1.9501e+01,  ...,  1.7245e+01,
            1.5484e+00, -1.3040e+01],
          [-1.9614e+01,  9.2935e+00,  4.7061e+01,  ...,  2.8261e+01,
            4.7712e-01, -2.2819e+01]],

         [[ 2.4914e+00,  2.5552e+00,  3.1902e+00,  ...,  4.0246e+00,
            4.2004e+00,  4.5936e+00],
          [ 2.5527e+00,  2.4664e+00,  2.6745e+00,  ...,  3.7322e+00,
            3.9465e+00,  4.7251e+00],
          [ 3.0034e+00,  2.5656e+00,  2.1343e+00,  ...,  2.8397e+00,
            3.7285e+00,  4.4659e+00],
          ...,
          [ 7.3927e+01,  6.8701e+01,  6.0577e+01,  ...,  2.9624e+01,
            2.5882e+01,  2.3594e+01],
          [ 6.6480e+01,  6.5936e+01,  6.1619e+01,  ...,  2.7881e+01,
            2.0574e+01,  1.5568e+01],
          [ 5.6905e+01,  5.6462e+01,  5.4476e+01,  ...,  2.4134e+01,
            1.9404e+01,  1.2735e+01]]],


        [[[-1.4970e+00, -6.8642e-01,  2.2158e-01,  ..., -1.7119e+00,
           -6.0402e-01,  1.0469e+00],
          [-1.1483e+00, -7.8772e-01, -5.9597e-01,  ..., -2.2653e+00,
           -1.2476e+00,  8.6835e-02],
          [-1.3815e+00, -1.3616e+00, -1.5167e+00,  ..., -2.0027e+00,
           -1.7034e+00, -1.3109e+00],
          ...,
          [-4.7387e+00, -7.3059e+00, -7.1722e+00,  ..., -8.6522e-01,
           -2.6967e+00,  2.1557e+00],
          [-1.3428e+01, -1.4029e+01, -1.3220e+01,  ..., -9.1253e+00,
           -6.7455e+00,  1.8294e+00],
          [-4.1635e+00,  1.6244e+00,  4.5459e+00,  ..., -1.2377e+01,
           -1.0201e+01, -4.7399e+00]],

         [[ 8.6304e-01,  6.2800e-01, -1.5441e-01,  ..., -1.3847e+00,
           -2.2171e+00, -3.5031e+00],
          [-1.2124e+00, -2.0566e+00, -2.7273e+00,  ..., -2.4875e+00,
           -3.5766e+00, -4.6983e+00],
          [-1.7556e+00, -2.9772e+00, -3.8154e+00,  ..., -2.0966e+00,
           -3.0938e+00, -4.0337e+00],
          ...,
          [-1.1778e+01, -1.8214e+01, -2.5555e+01,  ..., -8.2810e+00,
           -2.6046e+00, -5.4866e+00],
          [-3.7799e+01, -3.4560e+01, -4.0341e+01,  ..., -6.0459e+00,
            1.4189e+00, -2.4803e+00],
          [-5.1292e+01, -3.8012e+01, -3.2760e+01,  ..., -3.2384e+00,
           -5.0503e-01, -5.1603e+00]],

         [[ 3.1438e+00,  2.6887e+00,  2.4818e+00,  ...,  1.1686e+00,
            8.8895e-01,  9.5541e-01],
          [ 3.1794e+00,  2.6159e+00,  2.1458e+00,  ...,  1.0078e+00,
            6.1526e-01,  7.5839e-01],
          [ 2.5773e+00,  2.1888e+00,  1.7769e+00,  ...,  1.1280e+00,
            1.1905e+00,  1.3865e+00],
          ...,
          [ 1.7951e+01,  1.7200e+01,  1.8628e+01,  ...,  1.1115e+01,
            1.0923e+01,  1.2843e+01],
          [ 2.0482e+01,  2.2945e+01,  2.2010e+01,  ...,  1.1056e+01,
            1.0480e+01,  1.0945e+01],
          [ 2.5077e+01,  2.5552e+01,  2.2253e+01,  ...,  1.1297e+01,
            1.0878e+01,  1.1680e+01]],

         ...,

         [[ 4.2637e+00,  2.3285e+00,  5.2340e-01,  ...,  2.8999e+00,
            2.6085e+00,  1.9601e+00],
          [ 2.9124e+00,  1.1603e+00, -4.2039e-01,  ...,  2.1897e+00,
            2.6458e+00,  2.6852e+00],
          [ 2.8930e+00,  1.4178e+00,  5.4209e-02,  ...,  3.0047e+00,
            3.8600e+00,  4.3336e+00],
          ...,
          [ 1.9211e+01,  2.0125e+01,  2.2063e+01,  ...,  8.2092e+00,
            9.4873e+00,  6.7884e+00],
          [ 1.7132e+01,  2.4904e+01,  3.2191e+01,  ...,  6.3512e+00,
            4.2504e+00,  1.6820e+00],
          [ 1.1643e+01,  2.2879e+01,  3.3736e+01,  ...,  7.6160e+00,
            2.8478e+00, -2.8665e-01]],

         [[-3.7880e+00, -5.3146e+00, -5.9722e+00,  ...,  6.7997e+00,
            8.8110e+00,  9.1189e+00],
          [-4.4077e+00, -5.5966e+00, -6.1416e+00,  ...,  6.0067e+00,
            9.0471e+00,  9.8382e+00],
          [-1.9604e+00, -3.0933e+00, -3.7578e+00,  ...,  3.0881e+00,
            6.4858e+00,  7.6439e+00],
          ...,
          [-1.6268e+01, -9.4121e+00,  3.8563e+00,  ..., -4.7626e+00,
           -3.3485e-01, -2.1426e+00],
          [-2.6746e+01, -9.8711e+00,  1.9501e+01,  ...,  1.7245e+01,
            1.5484e+00, -1.3040e+01],
          [-1.9614e+01,  9.2935e+00,  4.7061e+01,  ...,  2.8261e+01,
            4.7712e-01, -2.2819e+01]],

         [[ 2.4914e+00,  2.5552e+00,  3.1902e+00,  ...,  4.0246e+00,
            4.2004e+00,  4.5936e+00],
          [ 2.5527e+00,  2.4664e+00,  2.6745e+00,  ...,  3.7322e+00,
            3.9465e+00,  4.7251e+00],
          [ 3.0034e+00,  2.5656e+00,  2.1343e+00,  ...,  2.8397e+00,
            3.7285e+00,  4.4659e+00],
          ...,
          [ 7.3927e+01,  6.8701e+01,  6.0577e+01,  ...,  2.9624e+01,
            2.5882e+01,  2.3594e+01],
          [ 6.6480e+01,  6.5936e+01,  6.1619e+01,  ...,  2.7881e+01,
            2.0574e+01,  1.5568e+01],
          [ 5.6905e+01,  5.6462e+01,  5.4476e+01,  ...,  2.4134e+01,
            1.9404e+01,  1.2735e+01]]],


        [[[-1.4970e+00, -6.8642e-01,  2.2158e-01,  ..., -1.7119e+00,
           -6.0402e-01,  1.0469e+00],
          [-1.1483e+00, -7.8772e-01, -5.9597e-01,  ..., -2.2653e+00,
           -1.2476e+00,  8.6835e-02],
          [-1.3815e+00, -1.3616e+00, -1.5167e+00,  ..., -2.0027e+00,
           -1.7034e+00, -1.3109e+00],
          ...,
          [-4.7387e+00, -7.3059e+00, -7.1722e+00,  ..., -8.6522e-01,
           -2.6967e+00,  2.1557e+00],
          [-1.3428e+01, -1.4029e+01, -1.3220e+01,  ..., -9.1253e+00,
           -6.7455e+00,  1.8294e+00],
          [-4.1635e+00,  1.6244e+00,  4.5459e+00,  ..., -1.2377e+01,
           -1.0201e+01, -4.7399e+00]],

         [[ 8.6304e-01,  6.2800e-01, -1.5441e-01,  ..., -1.3847e+00,
           -2.2171e+00, -3.5031e+00],
          [-1.2124e+00, -2.0566e+00, -2.7273e+00,  ..., -2.4875e+00,
           -3.5766e+00, -4.6983e+00],
          [-1.7556e+00, -2.9772e+00, -3.8154e+00,  ..., -2.0966e+00,
           -3.0938e+00, -4.0337e+00],
          ...,
          [-1.1778e+01, -1.8214e+01, -2.5555e+01,  ..., -8.2810e+00,
           -2.6046e+00, -5.4866e+00],
          [-3.7799e+01, -3.4560e+01, -4.0341e+01,  ..., -6.0459e+00,
            1.4189e+00, -2.4803e+00],
          [-5.1292e+01, -3.8012e+01, -3.2760e+01,  ..., -3.2384e+00,
           -5.0503e-01, -5.1603e+00]],

         [[ 3.1438e+00,  2.6887e+00,  2.4818e+00,  ...,  1.1686e+00,
            8.8895e-01,  9.5541e-01],
          [ 3.1794e+00,  2.6159e+00,  2.1458e+00,  ...,  1.0078e+00,
            6.1526e-01,  7.5839e-01],
          [ 2.5773e+00,  2.1888e+00,  1.7769e+00,  ...,  1.1280e+00,
            1.1905e+00,  1.3865e+00],
          ...,
          [ 1.7951e+01,  1.7200e+01,  1.8628e+01,  ...,  1.1115e+01,
            1.0923e+01,  1.2843e+01],
          [ 2.0482e+01,  2.2945e+01,  2.2010e+01,  ...,  1.1056e+01,
            1.0480e+01,  1.0945e+01],
          [ 2.5077e+01,  2.5552e+01,  2.2253e+01,  ...,  1.1297e+01,
            1.0878e+01,  1.1680e+01]],

         ...,

         [[ 4.2637e+00,  2.3285e+00,  5.2340e-01,  ...,  2.8999e+00,
            2.6085e+00,  1.9601e+00],
          [ 2.9124e+00,  1.1603e+00, -4.2039e-01,  ...,  2.1897e+00,
            2.6458e+00,  2.6852e+00],
          [ 2.8930e+00,  1.4178e+00,  5.4209e-02,  ...,  3.0047e+00,
            3.8600e+00,  4.3336e+00],
          ...,
          [ 1.9211e+01,  2.0125e+01,  2.2063e+01,  ...,  8.2092e+00,
            9.4873e+00,  6.7884e+00],
          [ 1.7132e+01,  2.4904e+01,  3.2191e+01,  ...,  6.3512e+00,
            4.2504e+00,  1.6820e+00],
          [ 1.1643e+01,  2.2879e+01,  3.3736e+01,  ...,  7.6160e+00,
            2.8478e+00, -2.8665e-01]],

         [[-3.7880e+00, -5.3146e+00, -5.9722e+00,  ...,  6.7997e+00,
            8.8110e+00,  9.1189e+00],
          [-4.4077e+00, -5.5966e+00, -6.1416e+00,  ...,  6.0067e+00,
            9.0471e+00,  9.8382e+00],
          [-1.9604e+00, -3.0933e+00, -3.7578e+00,  ...,  3.0881e+00,
            6.4858e+00,  7.6439e+00],
          ...,
          [-1.6268e+01, -9.4121e+00,  3.8563e+00,  ..., -4.7626e+00,
           -3.3485e-01, -2.1426e+00],
          [-2.6746e+01, -9.8711e+00,  1.9501e+01,  ...,  1.7245e+01,
            1.5484e+00, -1.3040e+01],
          [-1.9614e+01,  9.2935e+00,  4.7061e+01,  ...,  2.8261e+01,
            4.7712e-01, -2.2819e+01]],

         [[ 2.4914e+00,  2.5552e+00,  3.1902e+00,  ...,  4.0246e+00,
            4.2004e+00,  4.5936e+00],
          [ 2.5527e+00,  2.4664e+00,  2.6745e+00,  ...,  3.7322e+00,
            3.9465e+00,  4.7251e+00],
          [ 3.0034e+00,  2.5656e+00,  2.1343e+00,  ...,  2.8397e+00,
            3.7285e+00,  4.4659e+00],
          ...,
          [ 7.3927e+01,  6.8701e+01,  6.0577e+01,  ...,  2.9624e+01,
            2.5882e+01,  2.3594e+01],
          [ 6.6480e+01,  6.5936e+01,  6.1619e+01,  ...,  2.7881e+01,
            2.0574e+01,  1.5568e+01],
          [ 5.6905e+01,  5.6462e+01,  5.4476e+01,  ...,  2.4134e+01,
            1.9404e+01,  1.2735e+01]]]], device='cuda:1')



def load_model(model, params, checkpoint_file):
    ''' helper function to load model weights '''
    checkpoint_fname = checkpoint_file
    checkpoint = torch.load(checkpoint_fname)
    try:
        ''' FourCastNet is trained with distributed data parallel
            (DDP) which prepends 'module' to all keys. Non-DDP
            models need to strip this prefix '''
        new_state_dict = OrderedDict()
        for key, val in checkpoint['model_state'].items():
            name = key[7:]
            if name != 'ged':
                new_state_dict[name] = val
        model.load_state_dict(new_state_dict)
    except:
        model.load_state_dict(checkpoint['model_state'])
    model.eval() # set to inference mode
    return model

device = torch.device('cuda:1' if torch.cuda.is_available() else 'cpu')



# load the model
if params.nettype == 'afno':
    model = AFNONet(params).to(device)  # AFNO model
else:
    raise Exception("not implemented")
# load saved model weights
model = load_model(model, params, model_path)
model = model.to(device)


